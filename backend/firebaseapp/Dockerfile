FROM node:latest
WORKDIR /app

ARG FIREBASEAPP_PORT
ENV FIREBASEAPP_PORT=$FIREBASEAPP_PORT
ENV PORT=$FIREBASEAPP_PORT

ARG FIREBASE_API_KEY
ENV FIREBASE_API_KEY=$FIREBASE_API_KEY

ARG FIREBASE_AUTH_DOMAIN
ENV FIREBASE_AUTH_DOMAIN=$FIREBASE_AUTH_DOMAIN

ARG FIREBASE_PROJECT_ID
ENV FIREBASE_PROJECT_ID=$FIREBASE_PROJECT_ID

ARG FIREBASE_STORAGE_BUCKET
ENV FIREBASE_STORAGE_BUCKET=$FIREBASE_STORAGE_BUCKET

ARG FIREBASE_MESSAGING_SENDER_ID
ENV FIREBASE_MESSAGING_SENDER_ID=$FIREBASE_MESSAGING_SENDER_ID

ARG FIREBASE_APP_ID
ENV FIREBASE_APP_ID=$FIREBASE_APP_ID

ARG FIREBASE_MEASUREMENT_ID
ENV FIREBASE_MEASUREMENT_ID=$FIREBASE_MEASUREMENT_ID


RUN yarn global add firebase firebase-tools eslint babel-cli --ignore-engines

COPY ./package.json /app

RUN yarn

COPY ./app.js /app

#ENV GOOGLE_APPLICATION_CREDENTIALS /workspace/keys/default-appengine-service-key.json
EXPOSE $PORT

CMD npm run start
